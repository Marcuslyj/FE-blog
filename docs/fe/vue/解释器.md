# 解释器

解析器的作用是通过模板得到 AST（抽象语法树）。

生成 AST 的过程需要借助 HTML 解析器，当 HTML 解析器触发不同的**钩子函数**时，我们可以构建出不同的节点。

```js
parseHTML(template, {
  start(tag, attrs, unary) { 
    // 每当解析到标签的开始位置时，触发该函数
  },
  end() {
    // 每当解析到标签的结束位置时，触发该函数
  },
  chars(text) {
    // 每当解析到文本时，触发该函数
  },
  comment(text) {
    // 每当解析到注释时，触发该函数
  },
})
```

![](https://camo.githubusercontent.com/b5726c5705d0197cb3573dcb64bd95f8c30f2e09/68747470733a2f2f70302e73736c2e7168696d672e636f6d2f743031643135393137633934643561333462662e6a7067)

随后，我们可以通过**栈**来得到当前正在构建的节点的父节点，然后将构建出的节点添加到父节点的下面。

最终，当 HTML 解析器运行完毕后，我们就可以得到一个完整的带 DOM 层级关系的 AST。

HTML 解析器的内部原理是一小段一小段地截取模板字符串，每截取一小段字符串，就会根据截取出来的字符串类型触发不同的钩子函数，直到模板字符串截空停止运行。

文本分两种类型，不带变量的纯文本和带变量的文本，后者需要使用文本解析器进行二次加工。
